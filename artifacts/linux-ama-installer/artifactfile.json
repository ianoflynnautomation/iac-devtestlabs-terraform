{
  "$schema": "https://raw.githubusercontent.com/Azure/azure-devtestlab/master/schemas/2016-11-28/dtlArtifacts.json",
  "title": "Install or Update Azure Monitor Agent (AMA) for Linux",
  "publisher": "Community",
  "description": "Installs or updates the Azure Monitor Agent (AMA) for Linux distributions. This agent is required for Azure Monitor VM insights, Microsoft Sentinel, and other features that use Data Collection Rules (DCRs). This artifact can optionally associate the agent with a specified DCR upon installation.",
  "tags": [
    "AMA",
    "Azure Monitor",
    "Agent",
    "Linux",
    "DCR"
  ],
  "iconUri": "https://portal.azure.com/favicon.ico",
  "targetOsType": "Linux",
  "parameters": {
    "dataCollectionRuleId": {
      "type": "string",
      "displayName": "Data Collection Rule (DCR) ID",
      "description": "(Optional) The immutable ID of the Data Collection Rule to associate with this agent.",
      "allowEmpty": true,
      "defaultValue": ""
    }
  },
  "runCommand": {
    "commandToExecute": "[concat('python3 ./install_ama.py --dcr-id ''', parameters('dataCollectionRuleId'), '''')]"
  }
}